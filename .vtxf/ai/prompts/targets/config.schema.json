{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "vtxf/mcps-proxy/schema/config.schema.json",
  "title": "MCPS Proxy Configuration Schema",
  "description": "Configuration schema for mcps-proxy MCP server proxy tool",
  "type": "object",
  "required": [
    "server",
    "schemas"
  ],
  "properties": {
    "server": {
      "type": "object",
      "description": "HTTP server configuration",
      "required": [
        "port"
      ],
      "properties": {
        "port": {
          "type": "integer",
          "description": "HTTP server port number",
          "minimum": 1,
          "maximum": 65535,
          "default": 3095
        },
        "host": {
          "type": "string",
          "description": "HTTP server host address",
          "format": "hostname",
          "default": "0.0.0.0"
        },
        "cors": {
          "type": "object",
          "description": "CORS configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable CORS support",
              "default": true
            },
            "origins": {
              "type": "array",
              "description": "Allowed CORS origins",
              "items": {
                "oneOf": [
                  {
                    "type": "string",
                    "const": "*",
                    "description": "Wildcard to allow any origin"
                  },
                  {
                    "type": "string",
                    "format": "uri",
                    "description": "Specific origin URI"
                  }
                ]
              },
              "default": ["*"]
            },
            "methods": {
              "type": "array",
              "description": "Allowed HTTP methods",
              "items": {
                "type": "string",
                "enum": ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
              },
              "default": ["GET", "POST", "OPTIONS"]
            }
          }
        }
      }
    },
    "schemas": {
      "type": "object",
      "description": "Schema configurations for different environments",
      "patternProperties": {
        "^[a-zA-Z][a-zA-Z0-9_-]*$": {
          "type": "object",
          "description": "Individual schema configuration",
          "required": [
            "mcpServers"
          ],
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Whether this schema is enabled or disabled",
              "default": true
            },
            "mcpServers": {
              "type": "object",
              "description": "MCP server configurations for this schema",
              "patternProperties": {
                "^[a-zA-Z][a-zA-Z0-9_-]*$": {
                  "type": "object",
                  "description": "Individual MCP server configuration",
                  "oneOf": [
                    {
                      "$ref": "#/definitions/stdioServer"
                    },
                    {
                      "$ref": "#/definitions/httpServer"
                    },
                    {
                      "$ref": "#/definitions/sseServer"
                    }
                  ]
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "logging": {
      "type": "object",
      "description": "Logging configuration",
      "properties": {
        "level": {
          "type": "string",
          "description": "Log level",
          "enum": ["error", "warn", "info", "debug"],
          "default": "info"
        },
        "file": {
          "type": "string",
          "description": "Log file path",
          "default": "~/.mcps-proxy/logs/mcps-proxy.log"
        },
        "maxSize": {
          "type": "string",
          "description": "Maximum log file size",
          "pattern": "^[0-9]+[KMGT]?B$",
          "default": "10MB"
        },
        "maxFiles": {
          "type": "integer",
          "description": "Maximum number of log files to keep",
          "minimum": 1,
          "maximum": 100,
          "default": 5
        },
        "console": {
          "type": "boolean",
          "description": "Enable console logging",
          "default": true
        }
      }
    }
  },
  "additionalProperties": false,
  "definitions": {
    "stdioServer": {
      "type": "object",
      "description": "STDIO MCP server configuration",
      "required": [
        "command"
      ],
      "properties": {
        "type": {
          "type": "string",
          "description": "Server type",
          "const": "stdio"
        },
        "command": {
          "type": "string",
          "description": "Command to start the MCP server"
        },
        "args": {
          "type": "array",
          "description": "Command arguments",
          "items": {
            "type": "string"
          },
          "default": []
        },
        "env": {
          "type": "object",
          "description": "Environment variables",
          "patternProperties": {
            "^[A-Z_][A-Z0-9_]*$": {
              "type": "string",
              "description": "Environment variable value"
            }
          },
          "additionalProperties": false
        },
        "cwd": {
          "type": "string",
          "description": "Working directory",
          "default": "."
        },
        "timeout": {
          "type": "integer",
          "description": "Connection timeout in milliseconds",
          "minimum": 1000,
          "maximum": 300000,
          "default": 30000
        },
        "restart": {
          "type": "boolean",
          "description": "Auto restart on failure",
          "default": true
        },
        "restartDelay": {
          "type": "integer",
          "description": "Delay before restart in milliseconds",
          "minimum": 100,
          "maximum": 60000,
          "default": 5000
        }
      }
    },
    "httpServer": {
      "type": "object",
      "description": "HTTP MCP server configuration",
      "required": [
        "type",
        "url"
      ],
      "properties": {
        "type": {
          "type": "string",
          "description": "Server type",
          "const": "http"
        },
        "url": {
          "type": "string",
          "description": "HTTP server URL",
          "format": "uri"
        },
        "headers": {
          "type": "object",
          "description": "HTTP headers",
          "patternProperties": {
            "^[a-zA-Z][a-zA-Z0-9_-]*$": {
              "type": "string",
              "description": "Header value"
            }
          },
          "additionalProperties": false
        },
        "timeout": {
          "type": "integer",
          "description": "Request timeout in milliseconds",
          "minimum": 1000,
          "maximum": 300000,
          "default": 10000
        },
        "retries": {
          "type": "integer",
          "description": "Number of retry attempts",
          "minimum": 0,
          "maximum": 10,
          "default": 3
        },
        "retryDelay": {
          "type": "integer",
          "description": "Delay between retries in milliseconds",
          "minimum": 100,
          "maximum": 60000,
          "default": 1000
        }
      }
    },
    "sseServer": {
      "type": "object",
      "description": "SSE MCP server configuration",
      "required": [
        "type",
        "url"
      ],
      "properties": {
        "type": {
          "type": "string",
          "description": "Server type",
          "const": "sse"
        },
        "url": {
          "type": "string",
          "description": "SSE server URL",
          "format": "uri"
        },
        "headers": {
          "type": "object",
          "description": "SSE connection headers",
          "patternProperties": {
            "^[a-zA-Z][a-zA-Z0-9_-]*$": {
              "type": "string",
              "description": "Header value"
            }
          },
          "additionalProperties": false
        },
        "reconnectInterval": {
          "type": "integer",
          "description": "Reconnection interval in milliseconds",
          "minimum": 100,
          "maximum": 300000,
          "default": 1000
        },
        "maxRetries": {
          "type": "integer",
          "description": "Maximum reconnection attempts",
          "minimum": 0,
          "maximum": 100,
          "default": 5
        },
        "timeout": {
          "type": "integer",
          "description": "Connection timeout in milliseconds",
          "minimum": 1000,
          "maximum": 300000,
          "default": 30000
        }
      }
    }
  },
  "examples": [
    {
      "title": "Basic configuration",
      "description": "Minimal configuration with one stdio server",
      "config": {
        "server": {
          "port": 3095,
          "host": "0.0.0.0"
        },
        "schemas": {
          "default": {
            "enabled": true,
            "mcpServers": {
              "filesystem": {
                "command": "npx",
                "args": ["@modelcontextprotocol/server-filesystem", "."]
              }
            }
          }
        }
      }
    },
    {
      "title": "Multi-type configuration",
      "description": "Configuration with multiple server types",
      "config": {
        "server": {
          "port": 3095,
          "host": "0.0.0.0",
          "cors": {
            "enabled": true,
            "origins": ["http://localhost:3000"]
          }
        },
        "schemas": {
          "default": {
            "enabled": true,
            "mcpServers": {
              "filesystem": {
                "command": "npx",
                "args": ["@modelcontextprotocol/server-filesystem", "."]
              },
              "web-search": {
                "type": "http",
                "url": "https://api.example.com/mcp",
                "headers": {
                  "Authorization": "Bearer ${API_KEY}"
                },
                "timeout": 15000
              },
              "browser": {
                "type": "sse",
                "url": "http://localhost:9222/sse",
                "reconnectInterval": 5000,
                "maxRetries": 3
              }
            }
          }
        },
        "logging": {
          "level": "info",
          "file": "~/.mcps-proxy/logs/mcps-proxy.log",
          "console": true
        }
      }
    }
  ]
}